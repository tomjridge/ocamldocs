<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Tjr_kv__Kv_intf_v3 (tjr_kv.Tjr_kv__Kv_intf_v3)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">tjr_kv</a> &#x00BB; Tjr_kv__Kv_intf_v3</nav><h1>Module <code>Tjr_kv__Kv_intf_v3</code></h1><p>Interfaces based on a single &quot;store&quot; object with mutable refs.</p><p>NOTE the class types are not rendered well with odoc, so we reproduce them here.</p>

<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">sig</span>
  <span style="color: #008000; font-weight: bold">class</span> <span style="color: #008000; font-weight: bold">type</span> <span style="color: #666666">[</span><span style="color: #008000; font-weight: bold">&#39;</span>a<span style="color: #666666">]</span> mrshl <span style="color: #666666">=</span>
    <span style="color: #008000; font-weight: bold">object</span>
      <span style="color: #008000; font-weight: bold">method</span> of_blk <span style="color: #666666">:</span> <span style="color: #0000FF; font-weight: bold">Tjr_fs_shared</span>.<span style="color: #0000FF; font-weight: bold">Std_types</span>.blk <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">&#39;</span>a
      <span style="color: #008000; font-weight: bold">method</span> to_blk <span style="color: #666666">:</span> <span style="color: #008000; font-weight: bold">&#39;</span>a <span style="color: #666666">-&gt;</span> <span style="color: #0000FF; font-weight: bold">Tjr_fs_shared</span>.<span style="color: #0000FF; font-weight: bold">Std_types</span>.blk
    <span style="color: #008000; font-weight: bold">end</span>
  <span style="color: #008000; font-weight: bold">class</span> <span style="color: #666666">[</span><span style="color: #008000; font-weight: bold">&#39;</span>a<span style="color: #666666">]</span> set_once <span style="color: #666666">:</span>
    <span style="color: #008000; font-weight: bold">object</span>
      <span style="color: #008000; font-weight: bold">val</span> <span style="color: #008000; font-weight: bold">mutable</span> the_ref <span style="color: #666666">:</span> <span style="color: #008000; font-weight: bold">&#39;</span>a option
      <span style="color: #008000; font-weight: bold">method</span> get <span style="color: #666666">:</span> <span style="color: #008000; font-weight: bold">&#39;</span>a
      <span style="color: #008000; font-weight: bold">method</span> set <span style="color: #666666">:</span> <span style="color: #008000; font-weight: bold">&#39;</span>a <span style="color: #666666">-&gt;</span> <span style="color: #B00040">unit</span>
    <span style="color: #008000; font-weight: bold">end</span>
  <span style="color: #008000; font-weight: bold">class</span> <span style="color: #008000; font-weight: bold">virtual</span> <span style="color: #666666">[</span><span style="color: #008000; font-weight: bold">&#39;</span>rt<span style="color: #666666">]</span> syncable <span style="color: #666666">:</span>
    <span style="color: #008000; font-weight: bold">object</span>
      <span style="color: #008000; font-weight: bold">val</span> blk_dev_ops <span style="color: #666666">:</span>
        <span style="color: #666666">(</span><span style="color: #0000FF; font-weight: bold">Tjr_fs_shared</span>.<span style="color: #0000FF; font-weight: bold">Std_types</span>.blk_id<span style="color: #666666">,</span> <span style="color: #0000FF; font-weight: bold">Tjr_fs_shared</span>.<span style="color: #0000FF; font-weight: bold">Std_types</span>.blk<span style="color: #666666">,</span>
         <span style="color: #0000FF; font-weight: bold">Tjr_fs_shared</span>.<span style="color: #0000FF; font-weight: bold">Std_types</span>.t<span style="color: #666666">)</span>
        <span style="color: #0000FF; font-weight: bold">Tjr_fs_shared</span>.blk_dev_ops set_once
      <span style="color: #008000; font-weight: bold">val</span> blk_id <span style="color: #666666">:</span> <span style="color: #0000FF; font-weight: bold">Tjr_fs_shared</span>.<span style="color: #0000FF; font-weight: bold">Std_types</span>.blk_id set_once
      <span style="color: #008000; font-weight: bold">val</span> marshaller <span style="color: #666666">:</span> <span style="color: #008000; font-weight: bold">&#39;</span>rt mrshl set_once
      <span style="color: #008000; font-weight: bold">val</span> rt <span style="color: #666666">:</span> <span style="color: #008000; font-weight: bold">&#39;</span>rt set_once
      <span style="color: #008000; font-weight: bold">method</span> sync_from_disk <span style="color: #666666">:</span>
        <span style="color: #B00040">unit</span> <span style="color: #666666">-&gt;</span> <span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">&#39;</span>rt<span style="color: #666666">,</span> <span style="color: #0000FF; font-weight: bold">Tjr_fs_shared</span>.<span style="color: #0000FF; font-weight: bold">Std_types</span>.t<span style="color: #666666">)</span> <span style="color: #0000FF; font-weight: bold">Tjr_monad</span>.m
      <span style="color: #008000; font-weight: bold">method</span> sync_to_disk <span style="color: #666666">:</span>
        <span style="color: #B00040">unit</span> <span style="color: #666666">-&gt;</span> <span style="color: #666666">(</span><span style="color: #B00040">unit</span><span style="color: #666666">,</span> <span style="color: #0000FF; font-weight: bold">Tjr_fs_shared</span>.<span style="color: #0000FF; font-weight: bold">Std_types</span>.t<span style="color: #666666">)</span> <span style="color: #0000FF; font-weight: bold">Tjr_monad</span>.m
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>

</header><dl><dt class="spec type" id="type-rt_blk"><a href="#type-rt_blk" class="anchor"></a><code><span class="keyword">type</span> rt_blk</code><code> = </code><code>{</code><table class="record"><tr id="type-rt_blk.bt_rt" class="anchored"><td class="def field"><a href="#type-rt_blk.bt_rt" class="anchor"></a><code>bt_rt : Tjr_fs_shared.Std_types.blk_id;</code></td></tr><tr id="type-rt_blk.pc_hd" class="anchored"><td class="def field"><a href="#type-rt_blk.pc_hd" class="anchor"></a><code>pc_hd : Tjr_fs_shared.Std_types.blk_id;</code></td></tr><tr id="type-rt_blk.pc_tl" class="anchored"><td class="def field"><a href="#type-rt_blk.pc_tl" class="anchor"></a><code>pc_tl : Tjr_fs_shared.Std_types.blk_id;</code></td></tr></table><code>}</code></dt></dl><div><div class="spec include"><div class="doc"><dl><dt class="spec value" id="val-bin_shape_rt_blk"><a href="#val-bin_shape_rt_blk" class="anchor"></a><code><span class="keyword">val</span> bin_shape_rt_blk : Bin_prot.Shape.t</code></dt><dt class="spec value" id="val-bin_size_rt_blk"><a href="#val-bin_size_rt_blk" class="anchor"></a><code><span class="keyword">val</span> bin_size_rt_blk : <span><a href="index.html#type-rt_blk">rt_blk</a> Bin_prot.Size.sizer</span></code></dt><dt class="spec value" id="val-bin_write_rt_blk"><a href="#val-bin_write_rt_blk" class="anchor"></a><code><span class="keyword">val</span> bin_write_rt_blk : <span><a href="index.html#type-rt_blk">rt_blk</a> Bin_prot.Write.writer</span></code></dt><dt class="spec value" id="val-bin_writer_rt_blk"><a href="#val-bin_writer_rt_blk" class="anchor"></a><code><span class="keyword">val</span> bin_writer_rt_blk : <span><a href="index.html#type-rt_blk">rt_blk</a> Bin_prot.Type_class.writer</span></code></dt><dt class="spec value" id="val-__bin_read_rt_blk__"><a href="#val-__bin_read_rt_blk__" class="anchor"></a><code><span class="keyword">val</span> __bin_read_rt_blk__ : <span><span>(int <span>&#45;&gt;</span> <a href="index.html#type-rt_blk">rt_blk</a>)</span> Bin_prot.Read.reader</span></code></dt><dt class="spec value" id="val-bin_read_rt_blk"><a href="#val-bin_read_rt_blk" class="anchor"></a><code><span class="keyword">val</span> bin_read_rt_blk : <span><a href="index.html#type-rt_blk">rt_blk</a> Bin_prot.Read.reader</span></code></dt><dt class="spec value" id="val-bin_reader_rt_blk"><a href="#val-bin_reader_rt_blk" class="anchor"></a><code><span class="keyword">val</span> bin_reader_rt_blk : <span><a href="index.html#type-rt_blk">rt_blk</a> Bin_prot.Type_class.reader</span></code></dt><dt class="spec value" id="val-bin_rt_blk"><a href="#val-bin_rt_blk" class="anchor"></a><code><span class="keyword">val</span> bin_rt_blk : <span><a href="index.html#type-rt_blk">rt_blk</a> Bin_prot.Type_class.t</span></code></dt></dl></div></div></div><div class="spec module" id="module-Classes"><a href="#module-Classes" class="anchor"></a><code><span class="keyword">module</span> <a href="Classes/index.html">Classes</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <a href="index.html#module-Classes">Classes</a></code></span></summary><div class="spec class-type" id="class-type-mrshl"><a href="#class-type-mrshl" class="anchor"></a><code><span class="keyword">class</span> <span class="keyword">type</span> 'a <a href="class-type-mrshl/index.html">mrshl</a> = <span class="keyword">object</span> ... <span class="keyword">end</span></code></div><div class="spec class" id="class-set_once"><a href="#class-set_once" class="anchor"></a><code><span class="keyword">class</span> +'b <a href="class-set_once/index.html">set_once</a> : <span class="keyword">object</span> ... <span class="keyword">end</span></code></div><div class="spec class" id="class-syncable"><a href="#class-syncable" class="anchor"></a><code><span class="keyword">class</span> <span class="keyword">virtual</span> +'a <a href="class-syncable/index.html">syncable</a> : <span class="keyword">object</span> ... <span class="keyword">end</span></code></div></details></div></div></div></div></body></html>