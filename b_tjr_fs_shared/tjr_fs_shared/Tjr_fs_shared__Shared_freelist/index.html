<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Tjr_fs_shared__Shared_freelist (tjr_fs_shared.Tjr_fs_shared__Shared_freelist)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">tjr_fs_shared</a> &#x00BB; Tjr_fs_shared__Shared_freelist</nav><h1>Module <code>Tjr_fs_shared__Shared_freelist</code></h1><p>This is a shared type for blk freelists, and a dummy implementation; other libraries may have their own; don't open</p></header><dl><dt class="spec type" id="type-freelist_ops"><a href="#type-freelist_ops" class="anchor"></a><code><span class="keyword">type</span> <span>('blk_id, 't) freelist_ops</span></code><code> = </code><code>{</code><table class="record"><tr id="type-freelist_ops.alloc" class="anchored"><td class="def field"><a href="#type-freelist_ops.alloc" class="anchor"></a><code>alloc : unit <span>&#45;&gt;</span> <span><span>(<span class="type-var">'blk_id</span>, <span class="type-var">'t</span>)</span> Tjr_monad.m</span>;</code></td></tr><tr id="type-freelist_ops.alloc_many" class="anchored"><td class="def field"><a href="#type-freelist_ops.alloc_many" class="anchor"></a><code>alloc_many : int <span>&#45;&gt;</span> <span><span>(<span><span class="type-var">'blk_id</span> list</span>, <span class="type-var">'t</span>)</span> Tjr_monad.m</span>;</code></td></tr><tr id="type-freelist_ops.free" class="anchored"><td class="def field"><a href="#type-freelist_ops.free" class="anchor"></a><code>free : <span class="type-var">'blk_id</span> <span>&#45;&gt;</span> <span><span>(unit, <span class="type-var">'t</span>)</span> Tjr_monad.m</span>;</code></td></tr><tr id="type-freelist_ops.free_many" class="anchored"><td class="def field"><a href="#type-freelist_ops.free_many" class="anchor"></a><code>free_many : <span><span class="type-var">'blk_id</span> list</span> <span>&#45;&gt;</span> <span><span>(unit, <span class="type-var">'t</span>)</span> Tjr_monad.m</span>;</code></td></tr><tr id="type-freelist_ops.sync" class="anchored"><td class="def field"><a href="#type-freelist_ops.sync" class="anchor"></a><code>sync : unit <span>&#45;&gt;</span> <span><span>(unit, <span class="type-var">'t</span>)</span> Tjr_monad.m</span>;</code></td><td class="doc"><p>NOTE the freelist already ensures it is crash safe; this sync is really for tidy shutdown</p></td></tr></table><code>}</code></dt><dt class="spec type" id="type-freelist_factory"><a href="#type-freelist_factory" class="anchor"></a><code><span class="keyword">type</span> <span>('blk_id, 't, 'internal_state) freelist_factory</span></code><code> = &lt; with_ : <span>fn:string</span> <span>&#45;&gt;</span> &lt; create : <span>min_free:<span class="type-var">'blk_id</span></span> <span>&#45;&gt;</span> <span><span>(&lt; close : unit <span>&#45;&gt;</span> <span><span>(unit, <span class="type-var">'t</span>)</span> Tjr_monad.m</span>; freelist_ops : <span><span>(<span class="type-var">'blk_id</span>, <span class="type-var">'t</span>)</span> <a href="index.html#type-freelist_ops">freelist_ops</a></span>; get_state : unit <span>&#45;&gt;</span> <span class="type-var">'internal_state</span>; &gt;, <span class="type-var">'t</span>)</span> Tjr_monad.m</span>; restore : unit <span>&#45;&gt;</span> <span><span>(&lt; close : unit <span>&#45;&gt;</span> <span><span>(unit, <span class="type-var">'t</span>)</span> Tjr_monad.m</span>; freelist_ops : <span><span>(<span class="type-var">'blk_id</span>, <span class="type-var">'t</span>)</span> <a href="index.html#type-freelist_ops">freelist_ops</a></span>; get_state : unit <span>&#45;&gt;</span> <span class="type-var">'internal_state</span>; &gt;, <span class="type-var">'t</span>)</span> Tjr_monad.m</span>; &gt;; &gt;</code></dt><dd><p>NOTE these are just mocks, for testing</p></dd></dl><dl><dt class="spec module" id="module-Example"><a href="#module-Example" class="anchor"></a><code><span class="keyword">module</span> <a href="Example/index.html">Example</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Simple example, with just a &quot;min free&quot; int, backed by a file; good intro to how the freelist actually works</p></dd></dl><dl><dt class="spec value" id="val-example"><a href="#val-example" class="anchor"></a><code><span class="keyword">val</span> example : <span><span>(<a href="../Tjr_fs_shared/Shared_ctxt/index.html#type-r">Tjr_fs_shared.Shared_ctxt.r</a>, Tjr_monad.With_lwt.lwt, <a href="Example/index.html#type-t">Example.t</a>)</span> <a href="index.html#type-freelist_factory">freelist_factory</a></span></code></dt></dl><div class="spec module" id="module-Test"><a href="#module-Test" class="anchor"></a><code><span class="keyword">module</span> <a href="Test/index.html">Test</a> : <span class="keyword">functor</span> () <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div></div></body></html>