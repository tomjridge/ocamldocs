<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Lru_two_gen (tjr_lib_core.Tjr_lib_core__.Lru_two_gen)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">tjr_lib_core</a> &#x00BB; <a href="../index.html">Tjr_lib_core__</a> &#x00BB; Lru_two_gen</nav><h1>Module <code>Tjr_lib_core__.Lru_two_gen</code></h1></header><aside><p>A two-generation LRU with batch eviction.</p><p>This tries to take advantage of the extremely good performance of hashtables.</p><p>We assume a limit N on the number of most-recent items we want to track.</p><p>The idea is to maintain two maps (hence &quot;two generations&quot;). The first is of size n1 &lt;=N, and contains the n1 most recently used elements. The second is typically of size N, and the next (N-n1) most-recent elements are contained in this set. In the case where the set is of size n2 &lt; N, then only the most recent n1+n2 items are tracked (FIXME?)</p><p>When the first map reaches the limit N, it is demoted to the second map, and the second map is dropped. At this point, we need to expunge multiple elements from the cache, so this is &quot;batch eviction&quot;.</p><p>Looking up an item consults the first map first, then the second, then the underlying map.</p><p>Compared to standard LRU, the implementation is likely simpler and faster. Of course, you don't have full information about the ordering of the most-recently used items. But in the case where you are maintaining a cache, this doesn't matter so much.</p><p>NOTE a quick google search finds that this may be similar: https://github.com/dominictarr/hashlru , with some benchmarking here: https://github.com/dominictarr/bench-lru</p></aside><dl><dt class="spec type" id="type-m"><a href="#type-m" class="anchor"></a><code><span class="keyword">type</span> <span>('a, 't) m</span></code></dt><dt class="spec type" id="type-monad_ops"><a href="#type-monad_ops" class="anchor"></a><code><span class="keyword">type</span> <span>'t monad_ops</span></code><code> = </code><code>{</code><table class="record"><tr id="type-monad_ops.bind" class="anchored"><td class="def field"><a href="#type-monad_ops.bind" class="anchor"></a><code>bind : a b. <span><span>(<span class="type-var">'a</span>, <span class="type-var">'t</span>)</span> <a href="index.html#type-m">m</a></span> <span>&#45;&gt;</span> <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'b</span>, <span class="type-var">'t</span>)</span> <a href="index.html#type-m">m</a></span>)</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'b</span>, <span class="type-var">'t</span>)</span> <a href="index.html#type-m">m</a></span>;</code></td></tr><tr id="type-monad_ops.return" class="anchored"><td class="def field"><a href="#type-monad_ops.return" class="anchor"></a><code>return : a. <span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'t</span>)</span> <a href="index.html#type-m">m</a></span>;</code></td></tr></table><code>}</code></dt></dl><div class="spec module" id="module-Make"><a href="#module-Make" class="anchor"></a><code><span class="keyword">module</span> <a href="Make/index.html">Make</a> : <span class="keyword">functor</span> (<a href="Make/argument-1-S/index.html">S</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span>) <span>&#45;&gt;</span> <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="spec module" id="module-Test"><a href="#module-Test" class="anchor"></a><code><span class="keyword">module</span> <a href="Test/index.html">Test</a> : <span class="keyword">functor</span> () <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div></div></body></html>