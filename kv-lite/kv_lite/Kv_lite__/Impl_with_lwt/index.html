<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Impl_with_lwt (kv_lite.Kv_lite__.Impl_with_lwt)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">kv_lite</a> &#x00BB; <a href="../index.html">Kv_lite__</a> &#x00BB; Impl_with_lwt</nav><h1>Module <code>Kv_lite__.Impl_with_lwt</code></h1></header><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <a href="../../Kv_lite/Impl_intf/index.html#module-type-S_LWT">Kv_lite.Impl_intf.S_LWT</a></code></span></summary><div class="spec module" id="module-M"><a href="#module-M" class="anchor"></a><code><span class="keyword">module</span> <a href="M/index.html">M</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span> <span class="keyword">with</span> <span class="keyword">type</span> <span>'a <a href="M/index.html#type-t">t</a></span> = <span><span class="type-var">'a</span> Lwt.t</span></code></div><dl><dt class="spec type" id="type-op"><a href="#type-op" class="anchor"></a><code><span class="keyword">type</span> op</code><code> = string * <span>[ <span>`Insert of string</span> <span>| `Delete</span> ]</span></code></dt><dd><p>Operations are insert: (k,`Insert v), or delete: (k,`Delete)</p></dd></dl><dl><dt class="spec type" id="type-or_error"><a href="#type-or_error" class="anchor"></a><code><span class="keyword">type</span> <span>'a or_error</span></code><code> = <span><span>(<span class="type-var">'a</span>, string)</span> Stdlib.result</span></code></dt></dl><dl><dt class="spec value" id="val-error_to_exn"><a href="#val-error_to_exn" class="anchor"></a><code><span class="keyword">val</span> error_to_exn : <span><span class="type-var">'a</span> <a href="index.html#type-or_error">or_error</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="M/index.html#type-t">M.t</a></span></code></dt><dd><p>This unsafe function allows you to discard the error case; an exception will be raised at runtime; only use for testing!</p></dd></dl><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt><dd><p>runtime db connection; error hook; error flag</p></dd></dl><dl><dt class="spec value" id="val-open_"><a href="#val-open_" class="anchor"></a><code><span class="keyword">val</span> open_ : <span>fn:string</span> <span>&#45;&gt;</span> <span><span><a href="index.html#type-t">t</a> <a href="index.html#type-or_error">or_error</a></span> <a href="M/index.html#type-t">M.t</a></span></code></dt><dd><p>Error string if the db fails to open for some reason; kv-lite expects to use a lone database over which it has complete control; the default table name is &quot;kv_lite&quot; just in case you need it</p></dd></dl><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val</span> create : <span>fn:string</span> <span>&#45;&gt;</span> <span><span><a href="index.html#type-t">t</a> <a href="index.html#type-or_error">or_error</a></span> <a href="M/index.html#type-t">M.t</a></span></code></dt><dt class="spec value" id="val-close"><a href="#val-close" class="anchor"></a><code><span class="keyword">val</span> close : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>unit <a href="M/index.html#type-t">M.t</a></span></code></dt><dd><p>disconnect cannot throw an error in caqti</p></dd></dl><dl><dt class="spec value" id="val-set_error_hook"><a href="#val-set_error_hook" class="anchor"></a><code><span class="keyword">val</span> set_error_hook : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>(string <span>&#45;&gt;</span> unit)</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>Hook to catch post-initialization pre-close errors, which we hope do not occur; this allows the main insert/delete operations to avoid returning a result type. By default, this will exit the process, so be sure to set this in production code.</p></dd></dl><aside><p>Following single operations are slow -- they execute as a single transaction -- so use batch operations if possible</p></aside><dl><dt class="spec value" id="val-slow_insert"><a href="#val-slow_insert" class="anchor"></a><code><span class="keyword">val</span> slow_insert : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>unit <a href="M/index.html#type-t">M.t</a></span></code></dt><dd><p><code>slow_insert t k v</code></p></dd></dl><dl><dt class="spec value" id="val-slow_delete"><a href="#val-slow_delete" class="anchor"></a><code><span class="keyword">val</span> slow_delete : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>unit <a href="M/index.html#type-t">M.t</a></span></code></dt><dd><p><code>slow_delete t k v</code></p></dd></dl><dl><dt class="spec value" id="val-find_opt"><a href="#val-find_opt" class="anchor"></a><code><span class="keyword">val</span> find_opt : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span>string option</span> <a href="M/index.html#type-t">M.t</a></span></code></dt><dd><p><code>find_opt t k</code></p></dd></dl><dl><dt class="spec value" id="val-batch"><a href="#val-batch" class="anchor"></a><code><span class="keyword">val</span> batch : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="index.html#type-op">op</a> list</span> <span>&#45;&gt;</span> <span>unit <a href="M/index.html#type-t">M.t</a></span></code></dt><dd><p>following is fast because it batches multiple operations into a single transaction</p></dd></dl><dl><dt class="spec value" id="val-clear"><a href="#val-clear" class="anchor"></a><code><span class="keyword">val</span> clear : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>unit <a href="M/index.html#type-t">M.t</a></span></code></dt><dt class="spec value" id="val-last_batch_duration"><a href="#val-last_batch_duration" class="anchor"></a><code><span class="keyword">val</span> last_batch_duration : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> float</code></dt><dd><p>for profiling</p></dd></dl><dl><dt class="spec value" id="val-set_time"><a href="#val-set_time" class="anchor"></a><code><span class="keyword">val</span> set_time : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>(unit <span>&#45;&gt;</span> float)</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>update the standard timer (Sys.time) with a possibly more accurate one</p></dd></dl></details></div></div></div></div></body></html>