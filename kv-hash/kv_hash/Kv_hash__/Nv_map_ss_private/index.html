<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Nv_map_ss_private (kv_hash.Kv_hash__.Nv_map_ss_private)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">kv_hash</a> &#x00BB; <a href="../index.html">Kv_hash__</a> &#x00BB; Nv_map_ss_private</nav><h1>Module <code>Kv_hash__.Nv_map_ss_private</code></h1></header><aside><p>The core implementation is for a map <code>int-&gt;int</code>; here we add some additional support to enable a map <code>string-&gt;string</code>.</p><p>To lookup a particular string key:</p><ul><li>hash the key to get an int</li><li>use an int-&gt;int map to lookup the value_i (value as int)</li><li>value_i is an index into a table of string values, implemented as a single file of all values, and an offset into that file</li></ul><p>To add a key,value:</p><ul><li>hash the key to get an int</li><li>add the value to the values file to get an offset</li><li>add (hash,offset) to the int-&gt;int map</li></ul><p>To delete a key:</p><ul><li>hash the key to get an int</li><li>delete the int from the int-&gt;int map</li></ul><p>NOTE the old value still remains in the values file. Whether this is a problem depends on your application: if you often delete keys there may be substantial overhead in the values file.</p></aside><dl><dt class="spec value" id="val-hash"><a href="#val-hash" class="anchor"></a><code><span class="keyword">val</span> hash : string <span>&#45;&gt;</span> int</code></dt></dl><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> <span>'int_map t</span></code><code> = </code><code>{</code><table class="record"><tr id="type-t.values" class="anchored"><td class="def field"><a href="#type-t.values" class="anchor"></a><code>values : <a href="../../Kv_hash/Values_file/index.html#type-t">Kv_hash.Values_file.t</a>;</code></td></tr><tr id="type-t.nv_int_map" class="anchored"><td class="def field"><a href="#type-t.nv_int_map" class="anchor"></a><code><span class="keyword">mutable</span> nv_int_map : <span class="type-var">'int_map</span>;</code></td></tr><tr id="type-t.debug" class="anchored"><td class="def field"><a href="#type-t.debug" class="anchor"></a><code>debug : <span><span>(string, string)</span> Stdlib.Hashtbl.t</span>;</code></td></tr></table><code>}</code></dt><dd><p>A <code>string-&gt;string</code> map is a values file and an <code>int-&gt;int</code> map. The <code>int-&gt;int</code> map is really a map from hash(key) to offset(of value in values file).</p></dd></dl><div class="spec module" id="module-Make_1"><a href="#module-Make_1" class="anchor"></a><code><span class="keyword">module</span> <a href="Make_1/index.html">Make_1</a> : <span class="keyword">functor</span> (<a href="Make_1/argument-1-S0/index.html">S0</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span>) <span>&#45;&gt;</span> <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><dl><dt class="spec module" id="module-Make_2"><a href="#module-Make_2" class="anchor"></a><code><span class="keyword">module</span> <a href="Make_2/index.html">Make_2</a> : <span class="keyword">functor</span> (<a href="Make_2/argument-1-Raw_bucket/index.html">Raw_bucket</a> : <a href="../../Kv_hash/Bucket_intf/index.html#module-type-BUCKET">Kv_hash.Bucket_intf.BUCKET</a>) <span>&#45;&gt;</span> <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Putting it all together.</p></dd></dl><dl><dt class="spec module" id="module-Make_3"><a href="#module-Make_3" class="anchor"></a><code><span class="keyword">module</span> <a href="Make_3/index.html">Make_3</a> : <span class="keyword">functor</span> (<a href="Make_3/argument-1-Raw_bucket/index.html">Raw_bucket</a> : <a href="../../Kv_hash/Bucket_intf/index.html#module-type-BUCKET">Kv_hash.Bucket_intf.BUCKET</a>) <span>&#45;&gt;</span> <a href="../../Kv_hash/Nv_map_ss_intf/index.html#module-type-S">Kv_hash.Nv_map_ss_intf.S</a></code></dt><dd><p>NOTE prefer Make_2 since it provides the Nv_map_ii_ functions</p></dd></dl><div class="spec module" id="module-Nv_map_ss0"><a href="#module-Nv_map_ss0" class="anchor"></a><code><span class="keyword">module</span> <a href="Nv_map_ss0/index.html">Nv_map_ss0</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div></div></body></html>